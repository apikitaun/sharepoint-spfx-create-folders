{"version":3,"sources":["webparts/uploadPhoto/components/UploadPhoto.tsx"],"names":[],"mappings":"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","file":"webparts/uploadPhoto/components/UploadPhoto.js","sourcesContent":["import * as React from 'react';\r\nimport styles from './UploadPhoto.module.scss';\r\nimport { IUploadPhotoProps } from './IUploadPhotoProps';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport { SPHttpClient, SPHttpClientResponse,ISPHttpClientOptions} from '@microsoft/sp-http';\r\nimport {FolderProps} from './FolderProps';\r\n\r\nexport default class UploadPhoto extends React.Component<IUploadPhotoProps, {}> {\r\n  protected menu :HTMLSelectElement ;\r\n  protected name :HTMLInputElement;\r\n  protected countryCode: string;\r\n  protected fullPath: string;\r\n  public render(): React.ReactElement<IUploadPhotoProps> {\r\n    return (\r\n      <div className={ styles.uploadPhoto }>\r\n        <div className={ styles.container }>\r\n          <div className={ styles.row }>\r\n            <div className={ styles.column }>\r\n              <span className={ styles.subTitle }>Type</span>\r\n              <p><select id=\"type\" ref = {(input)=> this.menu= input}>\r\n                <option value=\"President\">Presidente</option>\r\n                <option value=\"SecretaryGeneral\">Secretario General</option>\r\n              </select></p> \r\n              <span className={ styles.subTitle }>Name</span>\r\n              <p><input type=\"text\" id=\"name\" ref={(input) => this.name= input}/></p>\r\n              <p className={ styles.subTitle }><a href=\"#\" onClick={e => this.ToFolder(e)}>Upload Image</a></p>\r\n              <p className={ styles.description }>{escape(this.props.description)}</p>\r\n              <a href=\"https://aka.ms/spfx\" className={ styles.button }>\r\n                <span className={ styles.label }>Learn more</span>\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  public ToFolder (e : any) : void\r\n  {\r\n    //alert ('hola '+ this.menu.value+ \" : \"+this.name.value);\r\n    this.countryCode = this.name.value;\r\n    this.fullPath = this.name.value +'/'+this.menu.value;\r\n    this.CreateFolderProcess();\r\n  }\r\n  private _existsFolder(name:string): Promise<FolderProps> {\r\n    var url = this.props.context.pageContext.web.absoluteUrl+\"/_api/web/GetFolderByServerRelativeUrl('PeopleImages/\"+name+\"')\";\r\n    console.log (\"[_existsFolder] FOLDER: \"+name);\r\n    console.log(\"[GET]: \"+url);\r\n    return this.props.context.spHttpClient.get(url,SPHttpClient.configurations.v1)\r\n       .then((response: SPHttpClientResponse) => {\r\n         return response.json();\r\n       }) as Promise<FolderProps>;\r\n  }\r\n  private _createFolder(name:string) : Promise<Response> {\r\n    var url = this.props.context.pageContext.web.absoluteUrl+\"/_api/web/folders/add('PeopleImages/\"+name+\"')\";\r\n    console.log(\"[POST]: \"+url);\r\n    var body = JSON.stringify({\r\n        '__metadata': {\r\n        'type': 'SP.Folder'},\r\n        'ServerRelativeUrl':'/PeopleImages'+name\r\n      });\r\n       return this.props.context.spHttpClient.post(url,SPHttpClient.configurations.v1,{\r\n         headers:{\r\n            'accept' : 'application/json',\r\n            'content-type' : 'application/json'\r\n         },\r\n         body: ''\r\n       })\r\n       .then((response: SPHttpClientResponse) => { return response.json(); \r\n      }) as Promise<Response>;\r\n      \r\n  }\r\n  private _openSharepointFolder(url:string) : void\r\n  {\r\n    window.open(url,'_blank');\r\n  }\r\n  private CreateFolderProcess ()\r\n  {\r\n    this._existsFolder(this.countryCode).then((response : FolderProps)=> {\r\n      if ( response.Exists == null)\r\n      {\r\n        console.log ('[_existsFolder] Folder: '+this.countryCode+' does not exists');\r\n        this._createFolder(this.countryCode)\r\n            .then((response: Response) =>\r\n            {\r\n               console.log('[_createFolder.RESPONSE]: '+response);\r\n               this._existsFolder(this.fullPath).then((response:FolderProps)=> {\r\n                 if ( response.Exists == null)\r\n                 {\r\n                    console.log ('[_existsFolder] Folder: '+this.countryCode+' does not exists');\r\n                    this._createFolder(this.fullPath).then((response:Response) => {\r\n                      this._openSharepointFolder(this.props.context.pageContext.web.absoluteUrl+\"/PeopleImages/\"+this.fullPath);\r\n                    });\r\n                 }\r\n                 else\r\n                 {\r\n                   this._openSharepointFolder(this.props.context.pageContext.web.absoluteUrl+\"/PeopleImages/\"+this.fullPath);\r\n                 }\r\n               });\r\n            });\r\n      }\r\n      else \r\n      {\r\n         console.log ('[_existsFolder] Folder '+this.countryCode+\" exists!\");\r\n         this._openSharepointFolder(this.props.context.pageContext.web.absoluteUrl+\"/PeopleImages/\"+this.fullPath);\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"../../../../src"}